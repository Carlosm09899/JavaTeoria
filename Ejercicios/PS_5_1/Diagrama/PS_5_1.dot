digraph PS_5_1 {
    // Configuración
    graph [bgcolor="transparent"];
    node [shape=rect, fontname="Arial", margin="0.1,0.1"];
    edge [fontname="Arial", fontsize=10];

    // Nodos
    INICIO [shape=ellipse, label="INICIO"];
    LEER_N [shape=parallelogram, label="Leer N"];
    CREAR_PRODS [label="Crear arreglo productos[N]"];
    BUCLE_LEER [shape=diamond, label="Para i de 0 a N-1"];
    LEER_PROD [shape=parallelogram, label="Leer datos del producto i"];
    
    // Menú
    BUCLE_MENU [shape=diamond, label="Bucle Infinito"];
    LEER_OPCION [shape=parallelogram, label="Leer opcion"];
    COND_SALIR [shape=diamond, label="opcion == 'e'"];
    LEER_CLAVE [shape=parallelogram, label="Leer clave"];
    BUSCAR_PROD [label="Buscar producto por clave"];
    COND_ENCONTRADO [shape=diamond, label="productoEncontrado != null"];
    PRINT_NO_ENC [shape=egg, label="Escribir 'Producto\nno encontrado'"];
    
    // Operaciones
    COND_OP_A [shape=diamond, label="opcion == 'a'"];
    COND_OP_B [shape=diamond, label="opcion == 'b'"];
    COND_OP_C [shape=diamond, label="opcion == 'c'"];
    COND_OP_D [shape=diamond, label="opcion == 'd'"];
    PRINT_OP_INV [shape=egg, label="Escribir 'Opción inválida'"];
    
    // Venta (a)
    LEER_CANT_A [shape=parallelogram, label="Leer cantidad"];
    COND_EXIST [shape=diamond, label="existencia < cantidad"];
    PROC_VENTA [label="existencia -= cantidad"];
    PRINT_NO_EXIST [shape=egg, label="Escribir 'No hay suficiente\nexistencia'"];
    PRINT_VENTA_OK [shape=egg, label="Escribir 'Venta realizada\ncorrectamente'"];
    COND_MIN [shape=diamond, label="existencia < minExistencia"];
    PRINT_WARNING [shape=egg, label="Escribir '¡Atención! Existencia\npor debajo del mínimo'"];
    
    // Reabastecer (b)
    LEER_CANT_B [shape=parallelogram, label="Leer cantidad"];
    VALIDAR_CANT_B [shape=diamond, label="cantidad <= 0"];
    PRINT_CANT_INV [shape=egg, label="Escribir 'La cantidad debe\nser positiva'"];
    PROC_REAB [label="existencia += cantidad"];
    PRINT_REAB_OK [shape=egg, label="Escribir 'Reabastecimiento\nrealizado correctamente'"];
    
    // Actualizar (c)
    LEER_PORC [shape=parallelogram, label="Leer porcentaje"];
    PROC_PRECIO [label="precioUnitario *= (1 + porcentaje/100)"];
    PRINT_PRECIO_OK [shape=egg, label="Escribir 'Precio actualizado\ncorrectamente'"];
    
    // Informar (d)
    IMPRIMIR_INFO [shape=egg, label="Escribir datos del producto"];
    FIN [shape=ellipse, label="FIN"];

    // Conexiones
    INICIO -> LEER_N -> CREAR_PRODS -> BUCLE_LEER -> LEER_PROD -> BUCLE_LEER;
    BUCLE_LEER -> BUCLE_MENU [label="Fin"];
    BUCLE_MENU -> LEER_OPCION -> COND_SALIR;
    COND_SALIR -> FIN [label="Si"]; 
    COND_SALIR -> LEER_CLAVE [label="No"];
    LEER_CLAVE -> BUSCAR_PROD -> COND_ENCONTRADO;
    COND_ENCONTRADO -> PRINT_NO_ENC [label="No"]; 
    PRINT_NO_ENC -> BUCLE_MENU;
    COND_ENCONTRADO -> COND_OP_A [label="Si"];
    
    // Venta
    COND_OP_A -> LEER_CANT_A [label="Si"]; 
    LEER_CANT_A -> COND_EXIST; 
    COND_EXIST -> PRINT_NO_EXIST [label="Si"]; 
    COND_EXIST -> PROC_VENTA [label="No"];
    PROC_VENTA -> PRINT_VENTA_OK;
    PRINT_VENTA_OK -> COND_MIN;
    COND_MIN -> PRINT_WARNING [label="Si"];
    COND_MIN -> BUCLE_MENU [label="No"];
    PRINT_WARNING -> BUCLE_MENU;
    PRINT_NO_EXIST -> BUCLE_MENU;
    
    // Reabastecer
    COND_OP_A -> COND_OP_B [label="No"];
    COND_OP_B -> LEER_CANT_B [label="Si"]; 
    LEER_CANT_B -> VALIDAR_CANT_B;
    VALIDAR_CANT_B -> PRINT_CANT_INV [label="Si"];
    VALIDAR_CANT_B -> PROC_REAB [label="No"];
    PRINT_CANT_INV -> BUCLE_MENU;
    PROC_REAB -> PRINT_REAB_OK -> BUCLE_MENU;
    
    // Actualizar
    COND_OP_B -> COND_OP_C [label="No"];
    COND_OP_C -> LEER_PORC [label="Si"]; 
    LEER_PORC -> PROC_PRECIO -> PRINT_PRECIO_OK -> BUCLE_MENU;
    
    // Informar
    COND_OP_C -> COND_OP_D [label="No"];
    COND_OP_D -> IMPRIMIR_INFO [label="Si"]; 
    IMPRIMIR_INFO -> BUCLE_MENU;
    COND_OP_D -> PRINT_OP_INV [label="No"]; 
    PRINT_OP_INV -> BUCLE_MENU;
}
